<%- include('partials/header', { title: title, user: user })  %>

<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <!-- Success Alert -->
      <% if (success) { %>
        <div class="alert alert-success alert-dismissible fade show" role="alert">
          <%= success %>
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      <% } %>

      <!-- Edit Profile Form -->
      <div class="card shadow-lg">
        <div class="card-body">
          <h2 class="card-title text-center mb-4">Edit Profile</h2>
          <form action="/user/edit" method="POST" enctype="multipart/form-data">
            <!-- Username Field -->
            <div class="form-group mb-3">
              <label for="username" class="form-label"><i class="fas fa-user me-2"></i>Username</label>
              <input 
                type="text" 
                class="form-control" 
                id="username" 
                name="username" 
                placeholder="Enter your username" 
                value="<%= user.username %>" 
                required 
              >
            </div>

            <!-- Email Field -->
            <div class="form-group mb-3">
              <label for="email" class="form-label"><i class="fas fa-envelope me-2"></i>Email</label>
              <input 
                type="email" 
                class="form-control" 
                id="email" 
                name="email" 
                placeholder="Enter your email address" 
                value="<%= user.email %>" 
                required 
              >
            </div>

            <!-- Bio Field -->
            <div class="form-group mb-3">
              <label for="bio" class="form-label"><i class="fas fa-info-circle me-2"></i>Bio</label>
              <textarea 
                class="form-control" 
                id="bio" 
                name="bio" 
                placeholder="Write something about yourself" 
                rows="5"
              ><%= user.bio %></textarea>
            </div>

            <!-- Profile Picture Field -->
            <div class="form-group mb-4">
              <label for="profilePicture" class="form-label"><i class="fas fa-image me-2"></i>Profile Picture</label>
              <input 
                type="file" 
                class="form-control" 
                id="profilePicture" 
                name="profilePicture" 
                accept="image/*"
              >
              <% if (user?.profilePicture?.url) { %>
                <div class="mt-3">
                  <p class="text-muted">Current Profile Picture:</p>
                  <img 
                    src="<%= user.profilePicture.url %>" 
                    alt="Profile Picture" 
                    class="img-fluid rounded shadow-sm" 
                    style="width: 150px; height: 150px; object-fit: cover;"
                  >
                </div>
              <% } %>
            </div>

            <!-- Save Changes Button -->
            <div class="text-center">
              <button type="submit" class="btn btn-primary">
                <i class="fas fa-save me-2"></i>Save Changes
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<%- include('partials/footer') %>
